# OpenProfilingAgent Environment Configuration
# Copy this file to .env and adjust values as needed
#
# Note: The docker-compose.yml uses these environment variables.
# Make sure to create the external network before starting:
#   docker network create opa_network

# ============================================
# Docker Compose Service Configuration
# ============================================
# These variables are used by docker-compose.yml services

# ClickHouse URL (used by agent service - container-to-container)
CLICKHOUSE_URL=http://clickhouse:8123

# Agent Configuration (used by agent service)
SOCKET_PATH=/var/run/opa.sock
TRANSPORT_TCP=:9090

# Timezone (used by all services)
TZ=Europe/Paris

# ============================================
# PHP Extension Configuration
# ============================================
# These are for PHP applications using the OPA extension
# 
# OPA_SOCKET_PATH format:
#   - Unix socket: /var/run/opa.sock (path starting with /)
#   - TCP/IP: host:port (e.g., host.docker.internal:10090)
#   - Auto-detected: paths starting with / are Unix sockets, otherwise TCP/IP
#
# For PHP running on HOST (outside Docker):
#   - Use host.docker.internal:10090 (mapped port from container)
#   - Or use socket if /var/run/opa.sock is mounted from Docker volume
#
# For PHP running in DOCKER (same network):
#   - Use agent:9090 (service name and container port)
#   - Or use /var/run/opa.sock if volume is shared
OPA_ENABLED=1
# Default: TCP connection from host to Docker container
OPA_SOCKET_PATH=host.docker.internal:10090
OPA_SAMPLING_RATE=1.0
OPA_FULL_CAPTURE_THRESHOLD_MS=100
OPA_STACK_DEPTH=20
OPA_BUFFER_SIZE=65536
OPA_COLLECT_INTERNAL_FUNCTIONS=1
OPA_DEBUG_LOG=0

# ============================================
# Service Ports (for reference)
# ============================================
# ClickHouse: 9000 (native), 8123 (HTTP)
#   - From host: host.docker.internal:8123
#   - From container: clickhouse:8123
# Agent API: 8081 (mapped from container 8080)
#   - From host: host.docker.internal:8081
#   - From container: agent:8080
# Agent Metrics: 2112
#   - From host: host.docker.internal:2112
#   - From container: agent:2112
# Agent TCP: 10090 (mapped from container 9090)
#   - From host: host.docker.internal:10090
#   - From container: agent:9090
# Prometheus: 9090
#   - From host: host.docker.internal:9090
#   - From container: opa-prometheus:9090
# Dashboard: 3000 (mapped from container 80)
#   - From host: localhost:3000 or host.docker.internal:3000
#   - From container: opa-dashboard:80

